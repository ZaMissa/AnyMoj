"use strict";(self.webpackChunktemp_app=self.webpackChunktemp_app||[]).push([[159],{1713:(e,s,n)=>{n.d(s,{Yq:()=>c,_x:()=>r,fw:()=>t});const a=e=>e?e instanceof Date?e:new Date(e):null,c=e=>{const s=a(e);return s?s.toLocaleDateString():"Never"},t=e=>{const s=a(e);if(!s)return"Never";const n=new Date,c=Math.floor((n.getTime()-s.getTime())/6e4);return c<1?"Just now":c<60?"".concat(c,"m ago"):c<1440?"".concat(Math.floor(c/60),"h ago"):c<10080?"".concat(Math.floor(c/1440),"d ago"):s.toLocaleDateString()},r=e=>{const s=a(e);if(!s)return"Never";const n=new Date,c=Math.floor((n.getTime()-s.getTime())/36e5);return c<1?"Just now":c<24?"".concat(c,"h ago"):c<168?"".concat(Math.floor(c/24),"d ago"):s.toLocaleDateString()}},4967:(e,s,n)=>{n.d(s,{A:()=>o});var a=n(5043),c=n(8431);const t=new class{async launchAnyDesk(e){try{const n=await c.indexedDBService.getMachine(e);if(!n)return{success:!1,method:"failed",error:"Machine not found"};await c.indexedDBService.logConnectionAttempt(e,"launch_attempt");const a="anydesk://".concat(n.anydeskId),t="https://anydesk.com/".concat(n.anydeskId);try{if(await this.openAnyDeskApp(a))return await c.indexedDBService.logConnectionAttempt(e,"launch_success","AnyDesk app launched"),{success:!0,method:"app"}}catch(s){console.log("AnyDesk app not available, trying web fallback")}try{return window.open(t,"_blank"),await c.indexedDBService.logConnectionAttempt(e,"launch_attempt","Opened web version"),{success:!0,method:"web"}}catch(s){return await c.indexedDBService.logConnectionAttempt(e,"launch_failure","Web fallback failed: ".concat(s)),{success:!1,method:"failed",error:"Failed to open AnyDesk app or web version"}}}catch(s){return console.error("AnyDesk launch error:",s),await c.indexedDBService.logConnectionAttempt(e,"launch_failure","Launch error: ".concat(s)),{success:!1,method:"failed",error:s instanceof Error?s.message:"Unknown error"}}}async openAnyDeskApp(e){return new Promise(s=>{const n=document.createElement("iframe");n.style.display="none",n.src=e;const a=setTimeout(()=>{document.body.removeChild(n),s(!1)},2e3),c=()=>{clearTimeout(a),document.body.removeChild(n),window.removeEventListener("focus",c),s(!0)};window.addEventListener("focus",c),document.body.appendChild(n);try{window.location.href=e,setTimeout(()=>{clearTimeout(a),document.body.removeChild(n),window.removeEventListener("focus",c),s(!0)},1e3)}catch(t){}})}async checkAnyDeskAvailability(){try{return!0}catch(e){return console.error("Error checking AnyDesk availability:",e),!1}}getAnyDeskDownloadUrl(){const e=navigator.userAgent.toLowerCase();return e.includes("windows")?"https://anydesk.com/downloads/windows":e.includes("mac")?"https://anydesk.com/downloads/macos":e.includes("linux")?"https://anydesk.com/downloads/linux":e.includes("android")?"https://play.google.com/store/apps/details?id=com.anydesk.anydeskandroid":e.includes("iphone")||e.includes("ipad")?"https://apps.apple.com/app/anydesk/id1114002967":"https://anydesk.com/downloads"}formatAnyDeskId(e){return e.replace(/\D/g,"").replace(/(\d{3})(?=\d)/g,"$1 ")}isValidAnyDeskId(e){const s=e.replace(/\D/g,"");return 9===s.length&&/^\d+$/.test(s)}getLaunchMessage(e,s){if(e.success){if("app"===e.method)return"AnyDesk app opened for ".concat(s,". If the connection doesn't start automatically, enter the ID: ").concat(e.method);if("web"===e.method)return"AnyDesk web version opened for ".concat(s,". You can also download the AnyDesk app for better experience.")}return"Failed to launch AnyDesk for ".concat(s,". ").concat(e.error||"Please ensure AnyDesk is installed or try again.")}};var r=n(4848),i=n(579);const o=e=>{let{machineId:s,machineName:n,anydeskId:c,size:o="md",variant:l="primary",onLaunchResult:d,className:h=""}=e;const[u,m]=(0,a.useState)(!1),[p,x]=(0,a.useState)(null);return(0,i.jsxs)("button",{className:(()=>{const e="anydesk-launch-btn-".concat(o),s="anydesk-launch-btn-".concat(l),n=u?"anydesk-launch-btn-loading":"",a=p?"anydesk-launch-btn-".concat(p.success?"success":"error"):"";return"".concat("anydesk-launch-btn"," ").concat(e," ").concat(s," ").concat(n," ").concat(a," ").concat(h).trim()})(),onClick:async()=>{if(!u)try{m(!0),x(null);const e=await t.launchAnyDesk(s);x(e),d&&d(e);const a=t.getLaunchMessage(e,n);if(e.success)"web"===e.method?alert("\u2705 ".concat(a,"\n\n\ud83d\udca1 Tip: Download AnyDesk app for better experience!")):alert("\u2705 ".concat(a));else{window.confirm("\u274c ".concat(a,"\n\nWould you like to download AnyDesk?"))&&window.open(t.getAnyDeskDownloadUrl(),"_blank")}}catch(e){console.error("Launch error:",e);const s={success:!1,method:"failed",error:e instanceof Error?e.message:"Unknown error"};x(s),d&&d(s),alert("\u274c Failed to launch AnyDesk: ".concat(s.error))}finally{m(!1)}},disabled:u,title:"Launch AnyDesk for ".concat(n," (ID: ").concat(c,")"),children:[(0,i.jsx)("span",{className:"anydesk-launch-btn-icon",children:u?(0,i.jsx)(r.A,{size:"sm"===o?"sm":"md"}):null!==p&&void 0!==p&&p.success?"\u2705":p&&!p.success?"\u274c":"\ud83d\ude80"}),(0,i.jsx)("span",{className:"anydesk-launch-btn-text",children:(()=>{if(u)return"sm"===o?"...":"Launching...";switch(l){case"icon":return"\ud83d\ude80";case"secondary":return"Connect to ".concat(n);default:return"Launch AnyDesk"}})()})]})}},6159:(e,s,n)=>{n.r(s),n.d(s,{default:()=>m});var a=n(5043),c=n(7697),t=n(8431),r=n(275),i=n(4848),o=n(4967),l=n(1713),d=n(6174),h=n(579);const u=e=>{let{machine:s}=e;return(0,h.jsxs)("div",{className:"machine-card",children:[(0,h.jsxs)(c.N_,{to:"/machine/".concat(s.id),className:"machine-card-link",children:[(0,h.jsxs)("div",{className:"machine-card-header",children:[(0,h.jsx)("h3",{className:"machine-name",children:s.name}),(0,h.jsx)("span",{className:"machine-connection-indicator",children:s.connectionCount>0&&(0,h.jsx)("span",{className:"connection-count",title:"Connected ".concat(s.connectionCount," times"),children:s.connectionCount})})]}),(0,h.jsx)("div",{className:"machine-id",children:s.anydeskId}),s.address&&(0,h.jsx)("div",{className:"machine-address",children:s.address}),s.tags.length>0&&(0,h.jsxs)("div",{className:"machine-tags",children:[s.tags.slice(0,3).map((e,s)=>(0,h.jsx)("span",{className:"machine-tag",children:e},s)),s.tags.length>3&&(0,h.jsxs)("span",{className:"machine-tag",children:["+",s.tags.length-3]})]}),(0,h.jsxs)("div",{className:"machine-footer",children:[(0,h.jsxs)("span",{className:"machine-last-accessed",children:["Last: ",(n=s.lastAccessed,(0,l._x)(n))]}),(0,h.jsxs)("span",{className:"machine-password-count",children:[s.passwords.length," password",1!==s.passwords.length?"s":""]})]})]}),(0,h.jsx)("div",{className:"machine-card-actions",children:(0,h.jsx)(o.A,{machineId:s.id,machineName:s.name,anydeskId:s.anydeskId,size:"sm",variant:"primary",onLaunchResult:e=>{console.log("AnyDesk launch result:",e)}})})]});var n},m=()=>{const[e,s]=(0,a.useState)([]),[n,o]=(0,a.useState)([]),[l,m]=(0,a.useState)(!0),[p,x]=(0,a.useState)(""),[y,g]=(0,a.useState)([]),[f,v]=(0,a.useState)([]),[j,w]=(0,a.useState)([]),[k,N]=(0,a.useState)(null),[b,D]=(0,a.useState)([]);(0,r.kx)([e]);const A=(0,a.useCallback)(()=>{let s=e;if(p.trim()){const e=p.toLowerCase();s=s.filter(s=>{var n,a;return s.name.toLowerCase().includes(e)||s.anydeskId.toLowerCase().includes(e)||(null===(n=s.address)||void 0===n?void 0:n.toLowerCase().includes(e))||(null===(a=s.notes)||void 0===a?void 0:a.toLowerCase().includes(e))||s.tags.some(s=>s.toLowerCase().includes(e))||s.categories.some(s=>s.toLowerCase().includes(e))})}y.length>0&&(s=s.filter(e=>y.some(s=>e.categories.includes(s)))),f.length>0&&(s=s.filter(e=>f.some(s=>e.tags.includes(s)))),null!==k&&(s=s.filter(e=>k?e.passwords.length>0:0===e.passwords.length)),j.length>0&&(s=s.filter(e=>j.includes(e.groupId||""))),D(s)},[e,p,y,f,j,k]);(0,a.useEffect)(()=>{(async()=>{try{m(!0);const e=await t.indexedDBService.getAllMachines();s(e)}catch(e){console.error("Failed to load machines:",e)}finally{m(!1)}})(),(async()=>{try{const e=await t.indexedDBService.getSettings();o((null===e||void 0===e?void 0:e.groups)||[])}catch(e){console.error("Failed to load groups:",e)}})()},[]),(0,a.useEffect)(()=>{A()},[A]);const C=(0,a.useCallback)(()=>{const s=new Set;return e.forEach(e=>{e.categories.forEach(e=>s.add(e))}),Array.from(s).sort()},[e]),S=(0,a.useCallback)(()=>{const s=new Set;return e.forEach(e=>{e.tags.forEach(e=>s.add(e))}),Array.from(s).sort()},[e]);return l?(0,h.jsxs)("div",{className:"dashboard-loading",children:[(0,h.jsx)(i.A,{size:"lg"}),(0,h.jsx)("p",{children:"Loading machines..."})]}):(0,h.jsxs)("div",{className:"dashboard",children:[(0,h.jsxs)("div",{className:"dashboard-header",children:[(0,h.jsxs)("div",{className:"dashboard-title-section",children:[(0,h.jsx)("h1",{className:"dashboard-title",children:"Machine Manager"}),(0,h.jsx)("span",{className:"version-indicator",children:d.U.getFormattedVersion()}),(0,h.jsx)("span",{className:"new-feature-badge",children:"\u2728 New"}),(0,h.jsx)("span",{className:"version-badge",children:"v1.0.4"})]}),(0,h.jsxs)("div",{className:"dashboard-stats",children:[(0,h.jsxs)("div",{className:"stat-card",children:[(0,h.jsx)("span",{className:"stat-number",children:e.length}),(0,h.jsx)("span",{className:"stat-label",children:"Total Machines"})]}),(0,h.jsxs)("div",{className:"stat-card",children:[(0,h.jsx)("span",{className:"stat-number",children:e.filter(e=>e.connectionCount>0).length}),(0,h.jsx)("span",{className:"stat-label",children:"Connected"})]}),(0,h.jsxs)("div",{className:"stat-card",children:[(0,h.jsx)("span",{className:"stat-number",children:e.filter(e=>e.lastAccessed).length}),(0,h.jsx)("span",{className:"stat-label",children:"Recently Used"})]})]})]}),(0,h.jsxs)("div",{className:"search-filter-bar",children:[(0,h.jsx)("input",{type:"text",placeholder:"Search machines by name, ID, address, or tags...",value:p,onChange:e=>{x(e.target.value)},className:"search-input"}),(0,h.jsxs)("div",{className:"filter-section",children:[(0,h.jsxs)("div",{className:"filter-group",children:[(0,h.jsx)("h4",{children:"Categories"}),(0,h.jsx)("div",{className:"filter-chips",children:C().map(e=>(0,h.jsx)("button",{className:"filter-chip ".concat(y.includes(e)?"active":""),onClick:()=>(e=>{g(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])})(e),children:e},e))})]}),(0,h.jsxs)("div",{className:"filter-group",children:[(0,h.jsx)("h4",{children:"Tags"}),(0,h.jsx)("div",{className:"filter-chips",children:S().map(e=>(0,h.jsx)("button",{className:"filter-chip ".concat(f.includes(e)?"active":""),onClick:()=>(e=>{v(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])})(e),children:e},e))})]}),(0,h.jsxs)("div",{className:"filter-group",children:[(0,h.jsx)("h4",{children:"Password"}),(0,h.jsxs)("div",{className:"filter-chips",children:[(0,h.jsx)("button",{className:"filter-chip ".concat(!0===k?"active":""),onClick:()=>N(!0!==k||null),children:"Has Passwords"}),(0,h.jsx)("button",{className:"filter-chip ".concat(!1===k?"active":""),onClick:()=>N(!1===k&&null),children:"No Passwords"})]})]}),n.length>0&&(0,h.jsxs)("div",{className:"filter-group",children:[(0,h.jsx)("h4",{children:"Groups"}),(0,h.jsx)("div",{className:"filter-chips",children:n.map(e=>(0,h.jsx)("button",{className:"filter-chip ".concat(j.includes(e.id)?"active":""),onClick:()=>{return s=e.id,void w(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s]);var s},style:{borderLeftColor:e.color},children:e.name},e.id))})]}),(y.length>0||f.length>0||j.length>0||null!==k)&&(0,h.jsx)("button",{className:"clear-filters-btn",onClick:()=>{x(""),g([]),v([]),w([]),N(null)},children:"Clear All Filters"})]})]}),(0,h.jsx)("div",{className:"dashboard-actions",children:(0,h.jsxs)(c.N_,{to:"/machine/new",className:"btn btn-primary",children:[(0,h.jsxs)("svg",{className:"btn-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,h.jsx)("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),(0,h.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Machine"]})}),0===b.length?(0,h.jsx)("div",{className:"empty-state",children:0===e.length?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"empty-state-icon",children:(0,h.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[(0,h.jsx)("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),(0,h.jsx)("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),(0,h.jsx)("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]})}),(0,h.jsx)("h3",{children:"No machines yet"}),(0,h.jsx)("p",{children:"Get started by adding your first machine to manage."}),(0,h.jsx)(c.N_,{to:"/machine/new",className:"btn btn-primary",children:"Add Your First Machine"})]}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"empty-state-icon",children:(0,h.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[(0,h.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,h.jsx)("path",{d:"m21 21-4.35-4.35"})]})}),(0,h.jsx)("h3",{children:"No machines found"}),(0,h.jsx)("p",{children:"Try adjusting your search terms."}),(0,h.jsx)("button",{className:"btn btn-secondary",onClick:()=>x(""),children:"Clear Search"})]})}):(0,h.jsx)("div",{className:"machine-grid",children:b.map(e=>(0,h.jsx)(u,{machine:e},e.id))})]})}}}]);
//# sourceMappingURL=159.66c604f6.chunk.js.map