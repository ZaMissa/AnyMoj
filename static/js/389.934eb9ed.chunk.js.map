{"version":3,"file":"static/js/389.934eb9ed.chunk.js","mappings":"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","sources":["services/export.service.ts","components/ExportImport.tsx","components/VersionDisplay.tsx","pages/Settings.tsx"],"sourcesContent":["import CryptoJS from 'crypto-js';\r\nimport { AppSettings, BackupData, ExportOptions, ImportResult } from '../types/machine.types';\r\n\r\nclass ExportService {\r\n  /**\r\n   * Export data to JSON format\r\n   */\r\n  async exportData(options: ExportOptions): Promise<Blob> {\r\n    const backupData: BackupData = {\r\n      version: '1.0.0',\r\n      exportDate: new Date(),\r\n      machines: [],\r\n      settings: {} as AppSettings,\r\n      history: []\r\n    };\r\n\r\n    // Get data based on export options\r\n    if (options.includeMachines) {\r\n      const { indexedDBService } = await import('./indexedDB.service');\r\n      if (options.selectedMachineIds && options.selectedMachineIds.length > 0) {\r\n        // Export selected machines only\r\n        for (const machineId of options.selectedMachineIds) {\r\n          const machine = await indexedDBService.getMachine(machineId);\r\n          if (machine) {\r\n            backupData.machines.push(machine);\r\n          }\r\n        }\r\n      } else {\r\n        // Export all machines\r\n        backupData.machines = await indexedDBService.getAllMachines();\r\n      }\r\n    }\r\n\r\n    if (options.includeSettings) {\r\n      const { indexedDBService } = await import('./indexedDB.service');\r\n      backupData.settings = await indexedDBService.getSettings();\r\n    }\r\n\r\n    if (options.includeHistory) {\r\n      const { indexedDBService } = await import('./indexedDB.service');\r\n      backupData.history = await indexedDBService.getConnectionHistory();\r\n    }\r\n\r\n    // Convert to JSON string\r\n    let jsonString = JSON.stringify(backupData, null, 2);\r\n\r\n    // Encrypt if requested\r\n    if (options.encrypt && options.password) {\r\n      const encrypted = CryptoJS.AES.encrypt(jsonString, options.password).toString();\r\n      const encryptedWrapper = {\r\n        encrypted: true,\r\n        data: encrypted,\r\n        version: backupData.version,\r\n        exportDate: backupData.exportDate\r\n      };\r\n      jsonString = JSON.stringify(encryptedWrapper, null, 2);\r\n      console.log('Encrypted export structure:', encryptedWrapper);\r\n    }\r\n\r\n    // Create blob with appropriate MIME type\r\n    const mimeType = options.encrypt ? 'application/json' : 'application/json';\r\n    return new Blob([jsonString], { type: mimeType });\r\n  }\r\n\r\n  /**\r\n   * Import data from JSON format\r\n   */\r\n  async importData(file: File, password?: string): Promise<ImportResult> {\r\n    const result: ImportResult = {\r\n      success: false,\r\n      importedMachines: 0,\r\n      importedSettings: false,\r\n      importedHistory: 0,\r\n      errors: [],\r\n      warnings: []\r\n    };\r\n\r\n    try {\r\n      // Read file content\r\n      const fileContent = await this.readFileAsText(file);\r\n      let backupData: BackupData;\r\n\r\n      try {\r\n        // Try to parse as JSON\r\n        const parsedData = JSON.parse(fileContent);\r\n\r\n        // Check if data is encrypted\r\n        if (parsedData.encrypted) {\r\n          if (!password) {\r\n            result.errors.push('File is encrypted but no password provided');\r\n            return result;\r\n          }\r\n\r\n          try {\r\n            // Decrypt the data\r\n            const decrypted = CryptoJS.AES.decrypt(parsedData.data, password).toString(CryptoJS.enc.Utf8);\r\n            if (!decrypted) {\r\n              result.errors.push('Invalid password or corrupted encrypted data');\r\n              return result;\r\n            }\r\n            \r\n            // Parse the decrypted JSON\r\n            try {\r\n              backupData = JSON.parse(decrypted);\r\n              console.log('Decrypted backup data structure:', backupData);\r\n            } catch (parseError) {\r\n              result.errors.push('Failed to parse decrypted data. File may be corrupted.');\r\n              console.error('JSON parse error:', parseError);\r\n              console.error('Decrypted string:', decrypted);\r\n              return result;\r\n            }\r\n          } catch (decryptError) {\r\n            result.errors.push('Failed to decrypt data. Check password.');\r\n            console.error('Decryption error:', decryptError);\r\n            return result;\r\n          }\r\n        } else {\r\n          backupData = parsedData;\r\n        }\r\n\r\n        // Validate backup data structure\r\n        if (!this.validateBackupData(backupData)) {\r\n          result.errors.push('Invalid backup file format. Expected: version, exportDate, machines, settings, history');\r\n          console.error('Validation failed for data:', backupData);\r\n          return result;\r\n        }\r\n\r\n        // Import data\r\n        await this.importBackupData(backupData, result);\r\n\r\n        result.success = true;\r\n      } catch (parseError) {\r\n        result.errors.push('Invalid JSON format in backup file');\r\n        return result;\r\n      }\r\n    } catch (fileError) {\r\n      result.errors.push(`Failed to read file: ${fileError}`);\r\n      return result;\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Generate filename for export\r\n   */\r\n  generateFilename(options: ExportOptions): string {\r\n    const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, 19);\r\n    const scope = options.selectedMachineIds ? 'selected' : 'all';\r\n    const encryption = options.encrypt ? 'encrypted' : 'plain';\r\n    return `machine-backup-${scope}-${encryption}-${timestamp}.json`;\r\n  }\r\n\r\n  /**\r\n   * Download blob as file\r\n   */\r\n  downloadBlob(blob: Blob, filename: string): void {\r\n    const url = URL.createObjectURL(blob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.download = filename;\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n    URL.revokeObjectURL(url);\r\n  }\r\n\r\n  /**\r\n   * Read file as text\r\n   */\r\n  private readFileAsText(file: File): Promise<string> {\r\n    return new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.onload = (e) => resolve(e.target?.result as string);\r\n      reader.onerror = (e) => reject(e);\r\n      reader.readAsText(file);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Validate backup data structure\r\n   */\r\n  private validateBackupData(data: any): data is BackupData {\r\n    try {\r\n      // Check basic structure\r\n      if (!data || typeof data !== 'object') {\r\n        console.error('Validation failed: data is not an object');\r\n        return false;\r\n      }\r\n\r\n      // Check required fields\r\n      if (typeof data.version !== 'string') {\r\n        console.error('Validation failed: version is not a string', data.version);\r\n        return false;\r\n      }\r\n\r\n      if (!data.exportDate) {\r\n        console.error('Validation failed: exportDate is missing');\r\n        return false;\r\n      }\r\n\r\n      if (!Array.isArray(data.machines)) {\r\n        console.error('Validation failed: machines is not an array', data.machines);\r\n        return false;\r\n      }\r\n\r\n      if (!Array.isArray(data.history)) {\r\n        console.error('Validation failed: history is not an array', data.history);\r\n        return false;\r\n      }\r\n\r\n      if (!data.settings || typeof data.settings !== 'object') {\r\n        console.error('Validation failed: settings is not an object', data.settings);\r\n        return false;\r\n      }\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Validation error:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Import backup data into IndexedDB\r\n   */\r\n  private async importBackupData(backupData: BackupData, result: ImportResult): Promise<void> {\r\n    const { indexedDBService } = await import('./indexedDB.service');\r\n\r\n    try {\r\n      // Import machines\r\n      for (const machine of backupData.machines) {\r\n        try {\r\n          const existingMachine = await indexedDBService.getMachine(machine.id);\r\n          \r\n          if (existingMachine) {\r\n            // Machine exists - update it\r\n            await indexedDBService.updateMachine(machine);\r\n            result.warnings.push(`Updated existing machine: ${machine.name}`);\r\n          } else {\r\n            // New machine - add it\r\n            await indexedDBService.addMachine(machine);\r\n            result.importedMachines++;\r\n          }\r\n        } catch (machineError) {\r\n          result.errors.push(`Failed to import machine ${machine.name}: ${machineError}`);\r\n        }\r\n      }\r\n\r\n      // Import history\r\n      for (const historyEntry of backupData.history) {\r\n        try {\r\n          await indexedDBService.addConnectionHistory(historyEntry);\r\n          result.importedHistory++;\r\n        } catch (historyError) {\r\n          result.warnings.push(`Failed to import history entry: ${historyError}`);\r\n        }\r\n      }\r\n\r\n      // Import settings (merge strategy)\r\n      try {\r\n        const currentSettings = await indexedDBService.getSettings();\r\n        const mergedSettings = this.mergeSettings(currentSettings, backupData.settings);\r\n        await indexedDBService.updateSettings(mergedSettings);\r\n        result.importedSettings = true;\r\n      } catch (settingsError) {\r\n        result.warnings.push(`Failed to import settings: ${settingsError}`);\r\n      }\r\n\r\n    } catch (error) {\r\n      result.errors.push(`Import failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Merge settings with existing settings\r\n   */\r\n  private mergeSettings(current: AppSettings, imported: AppSettings): AppSettings {\r\n    return {\r\n      ...current,\r\n      ...imported,\r\n      id: current.id, // Keep current ID\r\n      // Preserve some current settings while importing others\r\n      darkMode: imported.darkMode !== undefined ? imported.darkMode : current.darkMode,\r\n      autoBackup: imported.autoBackup !== undefined ? imported.autoBackup : current.autoBackup,\r\n      defaultEncryption: imported.defaultEncryption !== undefined ? imported.defaultEncryption : current.defaultEncryption,\r\n      // Merge categories and custom field definitions\r\n      categories: Array.from(new Set([...current.categories, ...imported.categories])),\r\n      customFieldDefinitions: this.mergeCustomFieldDefinitions(current.customFieldDefinitions, imported.customFieldDefinitions)\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Merge custom field definitions\r\n   */\r\n  private mergeCustomFieldDefinitions(current: any[], imported: any[]): any[] {\r\n    const merged = [...current];\r\n    \r\n    for (const importedField of imported) {\r\n      const existingIndex = merged.findIndex(field => field.id === importedField.id);\r\n      if (existingIndex >= 0) {\r\n        // Update existing field\r\n        merged[existingIndex] = importedField;\r\n      } else {\r\n        // Add new field\r\n        merged.push(importedField);\r\n      }\r\n    }\r\n    \r\n    return merged;\r\n  }\r\n\r\n  /**\r\n   * Detect if file is encrypted\r\n   */\r\n  async detectEncryption(file: File): Promise<boolean> {\r\n    try {\r\n      const content = await this.readFileAsText(file);\r\n      const parsed = JSON.parse(content);\r\n      return parsed.encrypted === true;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get export summary for UI display\r\n   */\r\n  async getExportSummary(options: ExportOptions): Promise<{\r\n    machineCount: number;\r\n    hasSettings: boolean;\r\n    hasHistory: boolean;\r\n    estimatedSize: string;\r\n  }> {\r\n    const { indexedDBService } = await import('./indexedDB.service');\r\n    \r\n    let machineCount = 0;\r\n    if (options.includeMachines) {\r\n      if (options.selectedMachineIds && options.selectedMachineIds.length > 0) {\r\n        machineCount = options.selectedMachineIds.length;\r\n      } else {\r\n        const allMachines = await indexedDBService.getAllMachines();\r\n        machineCount = allMachines.length;\r\n      }\r\n    }\r\n\r\n    const hasSettings = options.includeSettings;\r\n    \r\n    let hasHistory = false;\r\n    if (options.includeHistory) {\r\n      const history = await indexedDBService.getConnectionHistory();\r\n      hasHistory = history.length > 0;\r\n    }\r\n\r\n    // Estimate file size (rough calculation)\r\n    const estimatedSizeBytes = machineCount * 500 + (hasSettings ? 1000 : 0) + (hasHistory ? 200 : 0);\r\n    const estimatedSize = this.formatFileSize(estimatedSizeBytes);\r\n\r\n    return {\r\n      machineCount,\r\n      hasSettings,\r\n      hasHistory,\r\n      estimatedSize\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Format file size for display\r\n   */\r\n  private formatFileSize(bytes: number): string {\r\n    if (bytes === 0) return '0 Bytes';\r\n    const k = 1024;\r\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\r\n  }\r\n\r\n  /**\r\n   * Test export/import cycle for debugging\r\n   */\r\n  async testExportImportCycle(password: string = 'test123'): Promise<boolean> {\r\n    try {\r\n      console.log('Testing export/import cycle...');\r\n\r\n      // Test export\r\n      const exportBlob = await this.exportData({\r\n        includeMachines: true,\r\n        includeSettings: true,\r\n        includeHistory: true,\r\n        selectedMachineIds: [],\r\n        encrypt: true,\r\n        password\r\n      });\r\n\r\n      // Create a test file from the blob\r\n      const testFile = new File([exportBlob], 'test-backup.json', { type: 'application/json' });\r\n\r\n      // Test import\r\n      const importResult = await this.importData(testFile, password);\r\n      \r\n      console.log('Test result:', importResult);\r\n      return importResult.success;\r\n    } catch (error) {\r\n      console.error('Test failed:', error);\r\n      return false;\r\n    }\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const exportService = new ExportService();\r\n","import React, { useState, useRef } from 'react';\r\nimport { Machine } from '../types/machine.types';\r\nimport { exportService } from '../services/export.service';\r\nimport LoadingSpinner from './LoadingSpinner';\r\nimport './ExportImport.css';\r\n\r\ninterface ExportImportProps {\r\n  machines: Machine[];\r\n  onImportComplete?: (result: any) => void;\r\n}\r\n\r\nconst ExportImport: React.FC<ExportImportProps> = ({ machines, onImportComplete }) => {\r\n  const [isExporting, setIsExporting] = useState(false);\r\n  const [isImporting, setIsImporting] = useState(false);\r\n  const [exportOptions, setExportOptions] = useState({\r\n    includeMachines: true,\r\n    includeSettings: true,\r\n    includeHistory: true,\r\n    selectedMachineIds: [] as string[],\r\n    encrypt: false,\r\n    password: ''\r\n  });\r\n  const [importResult, setImportResult] = useState<any>(null);\r\n  const [showPasswordPrompt, setShowPasswordPrompt] = useState(false);\r\n  const [pendingFile, setPendingFile] = useState<File | null>(null);\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const handleExport = async () => {\r\n    if (exportOptions.encrypt && !exportOptions.password.trim()) {\r\n      alert('Please enter a password for encryption');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsExporting(true);\r\n      \r\n      const blob = await exportService.exportData(exportOptions);\r\n      const filename = exportService.generateFilename(exportOptions);\r\n      \r\n      exportService.downloadBlob(blob, filename);\r\n      \r\n      alert(`✅ Export completed! File: ${filename}`);\r\n    } catch (error) {\r\n      console.error('Export failed:', error);\r\n      alert(`❌ Export failed: ${error}`);\r\n    } finally {\r\n      setIsExporting(false);\r\n    }\r\n  };\r\n\r\n  const handleImport = async (file: File, password?: string) => {\r\n    try {\r\n      setIsImporting(true);\r\n      setImportResult(null);\r\n      \r\n      const result = await exportService.importData(file, password);\r\n      setImportResult(result);\r\n      \r\n      if (result.success) {\r\n        alert(`✅ Import completed!\\n\\nImported: ${result.importedMachines} machines, ${result.importedHistory} history entries${result.importedSettings ? ', settings' : ''}`);\r\n        if (onImportComplete) {\r\n          onImportComplete(result);\r\n        }\r\n      } else {\r\n        alert(`❌ Import failed:\\n${result.errors.join('\\n')}`);\r\n      }\r\n    } catch (error) {\r\n      console.error('Import failed:', error);\r\n      alert(`❌ Import failed: ${error}`);\r\n    } finally {\r\n      setIsImporting(false);\r\n    }\r\n  };\r\n\r\n  const handleFileSelect = async (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0];\r\n    if (!file) return;\r\n\r\n    // Reset file input\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = '';\r\n    }\r\n\r\n    try {\r\n      const isEncrypted = await exportService.detectEncryption(file);\r\n      \r\n      if (isEncrypted) {\r\n        setPendingFile(file);\r\n        setShowPasswordPrompt(true);\r\n      } else {\r\n        await handleImport(file);\r\n      }\r\n    } catch (error) {\r\n      console.error('File processing error:', error);\r\n      alert(`❌ Failed to process file: ${error}`);\r\n    }\r\n  };\r\n\r\n  const handlePasswordSubmit = async (password: string) => {\r\n    if (pendingFile) {\r\n      setShowPasswordPrompt(false);\r\n      await handleImport(pendingFile, password);\r\n      setPendingFile(null);\r\n    }\r\n  };\r\n\r\n  const toggleMachineSelection = (machineId: string) => {\r\n    setExportOptions(prev => ({\r\n      ...prev,\r\n      selectedMachineIds: prev.selectedMachineIds.includes(machineId)\r\n        ? prev.selectedMachineIds.filter(id => id !== machineId)\r\n        : [...prev.selectedMachineIds, machineId]\r\n    }));\r\n  };\r\n\r\n  const selectAllMachines = () => {\r\n    setExportOptions(prev => ({\r\n      ...prev,\r\n      selectedMachineIds: machines.map(m => m.id)\r\n    }));\r\n  };\r\n\r\n  const clearMachineSelection = () => {\r\n    setExportOptions(prev => ({\r\n      ...prev,\r\n      selectedMachineIds: []\r\n    }));\r\n  };\r\n\r\n  return (\r\n    <div className=\"export-import\">\r\n      <h3>Export & Import Data</h3>\r\n      \r\n      {/* Export Section */}\r\n      <div className=\"export-section\">\r\n        <h4>Export Data</h4>\r\n        \r\n        <div className=\"export-options\">\r\n          <div className=\"option-group\">\r\n            <label className=\"checkbox-label\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={exportOptions.includeMachines}\r\n                onChange={(e) => setExportOptions(prev => ({ ...prev, includeMachines: e.target.checked }))}\r\n              />\r\n              Include Machines\r\n            </label>\r\n            \r\n            {exportOptions.includeMachines && (\r\n              <div className=\"machine-selection\">\r\n                <div className=\"selection-controls\">\r\n                  <button type=\"button\" onClick={selectAllMachines} className=\"btn btn-sm\">\r\n                    Select All\r\n                  </button>\r\n                  <button type=\"button\" onClick={clearMachineSelection} className=\"btn btn-sm\">\r\n                    Clear All\r\n                  </button>\r\n                </div>\r\n                <div className=\"machine-list\">\r\n                  {machines.map(machine => (\r\n                    <label key={machine.id} className=\"checkbox-label\">\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={exportOptions.selectedMachineIds.includes(machine.id)}\r\n                        onChange={() => toggleMachineSelection(machine.id)}\r\n                      />\r\n                      {machine.name} ({machine.anydeskId})\r\n                    </label>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <label className=\"checkbox-label\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={exportOptions.includeSettings}\r\n              onChange={(e) => setExportOptions(prev => ({ ...prev, includeSettings: e.target.checked }))}\r\n            />\r\n            Include Settings\r\n          </label>\r\n\r\n          <label className=\"checkbox-label\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={exportOptions.includeHistory}\r\n              onChange={(e) => setExportOptions(prev => ({ ...prev, includeHistory: e.target.checked }))}\r\n            />\r\n            Include Connection History\r\n          </label>\r\n        </div>\r\n\r\n        <div className=\"encryption-section\">\r\n          <label className=\"checkbox-label\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={exportOptions.encrypt}\r\n              onChange={(e) => setExportOptions(prev => ({ ...prev, encrypt: e.target.checked }))}\r\n            />\r\n            Encrypt Export\r\n          </label>\r\n          \r\n          {exportOptions.encrypt && (\r\n            <div className=\"password-input\">\r\n              <input\r\n                type=\"password\"\r\n                placeholder=\"Enter encryption password\"\r\n                value={exportOptions.password}\r\n                onChange={(e) => setExportOptions(prev => ({ ...prev, password: e.target.value }))}\r\n                className=\"form-input\"\r\n              />\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <button\r\n          onClick={handleExport}\r\n          disabled={isExporting}\r\n          className=\"btn btn-primary\"\r\n        >\r\n          {isExporting ? (\r\n            <>\r\n              <LoadingSpinner size=\"sm\" />\r\n              Exporting...\r\n            </>\r\n          ) : (\r\n            'Export Data'\r\n          )}\r\n        </button>\r\n      </div>\r\n\r\n      {/* Import Section */}\r\n      <div className=\"import-section\">\r\n        <h4>Import Data</h4>\r\n        \r\n        <div className=\"import-info\">\r\n          <p>Import data from a previously exported backup file. The import will merge with existing data.</p>\r\n        </div>\r\n\r\n        <div className=\"file-input-container\">\r\n          <input\r\n            ref={fileInputRef}\r\n            type=\"file\"\r\n            accept=\".json\"\r\n            onChange={handleFileSelect}\r\n            className=\"file-input\"\r\n            id=\"import-file\"\r\n          />\r\n          <label htmlFor=\"import-file\" className=\"file-input-label\">\r\n            {isImporting ? (\r\n              <>\r\n                <LoadingSpinner size=\"sm\" />\r\n                Importing...\r\n              </>\r\n            ) : (\r\n              'Choose Backup File'\r\n            )}\r\n          </label>\r\n        </div>\r\n\r\n        {importResult && (\r\n          <div className={`import-result ${importResult.success ? 'success' : 'error'}`}>\r\n            <h5>Import Result</h5>\r\n            <p>✅ Imported: {importResult.importedMachines} machines, {importResult.importedHistory} history entries</p>\r\n            {importResult.importedSettings && <p>✅ Settings imported</p>}\r\n            {importResult.errors.length > 0 && (\r\n              <div className=\"errors\">\r\n                <h6>Errors:</h6>\r\n                <ul>\r\n                  {importResult.errors.map((error: string, index: number) => (\r\n                    <li key={index}>{error}</li>\r\n                  ))}\r\n                </ul>\r\n              </div>\r\n            )}\r\n            {importResult.warnings.length > 0 && (\r\n              <div className=\"warnings\">\r\n                <h6>Warnings:</h6>\r\n                <ul>\r\n                  {importResult.warnings.map((warning: string, index: number) => (\r\n                    <li key={index}>{warning}</li>\r\n                  ))}\r\n                </ul>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Password Prompt Modal */}\r\n      {showPasswordPrompt && (\r\n        <div className=\"password-modal-overlay\">\r\n          <div className=\"password-modal\">\r\n            <h4>Encrypted File</h4>\r\n            <p>This backup file is encrypted. Please enter the password:</p>\r\n            <PasswordPrompt\r\n              onSubmit={handlePasswordSubmit}\r\n              onCancel={() => {\r\n                setShowPasswordPrompt(false);\r\n                setPendingFile(null);\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Password prompt component\r\nconst PasswordPrompt: React.FC<{\r\n  onSubmit: (password: string) => void;\r\n  onCancel: () => void;\r\n}> = ({ onSubmit, onCancel }) => {\r\n  const [password, setPassword] = useState('');\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (password.trim()) {\r\n      onSubmit(password.trim());\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"password-form\">\r\n      <input\r\n        type=\"password\"\r\n        value={password}\r\n        onChange={(e) => setPassword(e.target.value)}\r\n        placeholder=\"Enter password\"\r\n        className=\"form-input\"\r\n        autoFocus\r\n      />\r\n      <div className=\"form-actions\">\r\n        <button type=\"button\" onClick={onCancel} className=\"btn btn-secondary\">\r\n          Cancel\r\n        </button>\r\n        <button type=\"submit\" className=\"btn btn-primary\" disabled={!password.trim()}>\r\n          Import\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default ExportImport;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { versionService, VersionInfo } from '../services/version.service';\r\nimport './VersionDisplay.css';\r\n\r\ninterface VersionDisplayProps {\r\n  showUpdateButton?: boolean;\r\n  className?: string;\r\n}\r\n\r\nconst VersionDisplay: React.FC<VersionDisplayProps> = ({ \r\n  showUpdateButton = true, \r\n  className = '' \r\n}) => {\r\n  const [versionInfo, setVersionInfo] = useState<VersionInfo | null>(null);\r\n  const [isChecking, setIsChecking] = useState(false);\r\n  const [showDetails, setShowDetails] = useState(false);\r\n\r\n  useEffect(() => {\r\n    loadVersionInfo();\r\n  }, []);\r\n\r\n  const loadVersionInfo = () => {\r\n    const info = versionService.getStoredVersionInfo();\r\n    setVersionInfo(info);\r\n  };\r\n\r\n  const handleCheckForUpdates = async () => {\r\n    setIsChecking(true);\r\n    try {\r\n      const result = await versionService.forceUpdateCheck();\r\n      loadVersionInfo(); // Reload to get updated info\r\n    } catch (error) {\r\n      console.error('Failed to check for updates:', error);\r\n    } finally {\r\n      setIsChecking(false);\r\n    }\r\n  };\r\n\r\n  const handleUpdate = () => {\r\n    if (versionInfo?.updateUrl) {\r\n      window.open(versionInfo.updateUrl, '_blank');\r\n    } else {\r\n      // Fallback to page reload\r\n      window.location.reload();\r\n    }\r\n  };\r\n\r\n  if (!versionInfo) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className={`version-display ${className}`}>\r\n      <div className=\"version-info\">\r\n        <span className=\"version-text\">\r\n          {versionService.getFormattedVersion()}\r\n        </span>\r\n        \r\n        {versionInfo.isUpdateAvailable && (\r\n          <span className=\"update-badge\">\r\n            Update Available\r\n          </span>\r\n        )}\r\n        \r\n        <button\r\n          className=\"version-toggle-btn\"\r\n          onClick={() => setShowDetails(!showDetails)}\r\n          title={showDetails ? 'Hide details' : 'Show details'}\r\n        >\r\n          {showDetails ? '▼' : '▶'}\r\n        </button>\r\n      </div>\r\n\r\n      {showDetails && (\r\n        <div className=\"version-details\">\r\n          <div className=\"version-detail-item\">\r\n            <span className=\"detail-label\">Current:</span>\r\n            <span className=\"detail-value\">v{versionInfo.current}</span>\r\n          </div>\r\n          \r\n          <div className=\"version-detail-item\">\r\n            <span className=\"detail-label\">Latest:</span>\r\n            <span className=\"detail-value\">v{versionInfo.latest}</span>\r\n          </div>\r\n          \r\n          {versionInfo.lastChecked && (\r\n            <div className=\"version-detail-item\">\r\n              <span className=\"detail-label\">Last checked:</span>\r\n              <span className=\"detail-value\">\r\n                {versionInfo.lastChecked.toLocaleDateString()} {versionInfo.lastChecked.toLocaleTimeString()}\r\n              </span>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"version-actions\">\r\n            <button\r\n              className=\"btn btn-sm btn-secondary\"\r\n              onClick={handleCheckForUpdates}\r\n              disabled={isChecking}\r\n            >\r\n              {isChecking ? 'Checking...' : 'Check for Updates'}\r\n            </button>\r\n            \r\n            {versionInfo.isUpdateAvailable && showUpdateButton && (\r\n              <button\r\n                className=\"btn btn-sm btn-primary\"\r\n                onClick={handleUpdate}\r\n              >\r\n                Update Now\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VersionDisplay;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { AppSettings, Machine } from '../types/machine.types';\r\nimport { indexedDBService } from '../services/indexedDB.service';\r\nimport { backupService } from '../services/backup.service';\r\nimport LoadingSpinner from '../components/LoadingSpinner';\r\nimport ExportImport from '../components/ExportImport';\r\nimport VersionDisplay from '../components/VersionDisplay';\r\nimport './Settings.css';\r\n\r\nconst Settings: React.FC = () => {\r\n  const [settings, setSettings] = useState<AppSettings | null>(null);\r\n  const [machines, setMachines] = useState<Machine[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n\r\n  useEffect(() => {\r\n    loadSettings();\r\n    loadMachines();\r\n  }, []);\r\n\r\n  const loadSettings = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const settingsData = await indexedDBService.getSettings();\r\n      setSettings(settingsData);\r\n      \r\n      // Apply dark mode on load\r\n      if (settingsData?.darkMode) {\r\n        document.documentElement.classList.add('dark');\r\n      } else {\r\n        document.documentElement.classList.remove('dark');\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load settings:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadMachines = async () => {\r\n    try {\r\n      const allMachines = await indexedDBService.getAllMachines();\r\n      setMachines(allMachines);\r\n    } catch (error) {\r\n      console.error('Failed to load machines:', error);\r\n    }\r\n  };\r\n\r\n  const handleSettingChange = async (field: keyof AppSettings, value: any) => {\r\n    if (settings) {\r\n      const newSettings = { ...settings, [field]: value };\r\n      setSettings(newSettings);\r\n      \r\n      // Apply dark mode immediately for better UX\r\n      if (field === 'darkMode') {\r\n        if (value) {\r\n          document.documentElement.classList.add('dark');\r\n        } else {\r\n          document.documentElement.classList.remove('dark');\r\n        }\r\n        \r\n        // Auto-save dark mode setting immediately\r\n        try {\r\n          await indexedDBService.updateSettings(newSettings);\r\n        } catch (error) {\r\n          console.error('Failed to save dark mode setting:', error);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const saveSettings = async () => {\r\n    if (!settings) return;\r\n\r\n    try {\r\n      setSaving(true);\r\n      await indexedDBService.updateSettings(settings);\r\n      \r\n      // Apply dark mode class to document\r\n      if (settings.darkMode) {\r\n        document.documentElement.classList.add('dark');\r\n      } else {\r\n        document.documentElement.classList.remove('dark');\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to save settings:', error);\r\n      alert('Failed to save settings. Please try again.');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n\r\n  const clearAllData = async () => {\r\n    // Create a custom confirmation dialog with backup checkbox\r\n    const confirmed = await showBackupConfirmationDialog();\r\n    if (!confirmed) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Clear backup first to prevent auto-restore\r\n      await backupService.clearBackup();\r\n      \r\n      // Clear all data from IndexedDB\r\n      await indexedDBService.clearAllData();\r\n      \r\n      // Set a flag to prevent auto-restore on next load\r\n      localStorage.setItem('skipAutoRestore', 'true');\r\n      \r\n      // Set a flag to show theme chooser after reload\r\n      localStorage.setItem('showThemeChooser', 'true');\r\n      \r\n      alert('All data has been cleared. The app will reload and show theme selection.');\r\n      window.location.reload();\r\n    } catch (error) {\r\n      console.error('Failed to clear data:', error);\r\n      alert('Failed to clear data. Please try again.');\r\n    }\r\n  };\r\n\r\n  const showBackupConfirmationDialog = (): Promise<boolean> => {\r\n    return new Promise((resolve) => {\r\n      // Create modal overlay\r\n      const overlay = document.createElement('div');\r\n      overlay.style.cssText = `\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n        background: rgba(0, 0, 0, 0.5);\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        z-index: 10000;\r\n      `;\r\n\r\n      // Create modal content\r\n      const modal = document.createElement('div');\r\n      modal.style.cssText = `\r\n        background: white;\r\n        padding: 24px;\r\n        border-radius: 8px;\r\n        max-width: 400px;\r\n        width: 90%;\r\n        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\r\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\r\n      `;\r\n\r\n      modal.innerHTML = `\r\n        <h3 style=\"margin: 0 0 16px 0; color: #d32f2f; font-size: 18px;\">⚠️ Clear All Data</h3>\r\n        <p style=\"margin: 0 0 16px 0; color: #333; line-height: 1.5;\">\r\n          This will permanently delete ALL your machines, connection history, and settings. \r\n          <strong>This action cannot be undone!</strong>\r\n        </p>\r\n        <p style=\"margin: 0 0 16px 0; color: #666; font-size: 14px;\">\r\n          Before proceeding, please ensure you have exported your data as a backup.\r\n        </p>\r\n        <label style=\"display: flex; align-items: center; margin: 16px 0; cursor: pointer;\">\r\n          <input type=\"checkbox\" id=\"backup-confirmation\" style=\"margin-right: 8px;\">\r\n          <span style=\"color: #333; font-weight: 500;\">\r\n            I confirm that I have made a backup of my data and understand this action is irreversible\r\n          </span>\r\n        </label>\r\n        <div style=\"display: flex; gap: 12px; justify-content: flex-end; margin-top: 24px;\">\r\n          <button id=\"cancel-btn\" style=\"\r\n            padding: 8px 16px;\r\n            border: 1px solid #ccc;\r\n            background: white;\r\n            border-radius: 4px;\r\n            cursor: pointer;\r\n            color: #333;\r\n          \">Cancel</button>\r\n          <button id=\"confirm-btn\" style=\"\r\n            padding: 8px 16px;\r\n            border: none;\r\n            background: #d32f2f;\r\n            color: white;\r\n            border-radius: 4px;\r\n            cursor: pointer;\r\n            opacity: 0.5;\r\n          \" disabled>Clear All Data</button>\r\n        </div>\r\n      `;\r\n\r\n      overlay.appendChild(modal);\r\n      document.body.appendChild(overlay);\r\n\r\n      const checkbox = modal.querySelector('#backup-confirmation') as HTMLInputElement;\r\n      const cancelBtn = modal.querySelector('#cancel-btn') as HTMLButtonElement;\r\n      const confirmBtn = modal.querySelector('#confirm-btn') as HTMLButtonElement;\r\n\r\n      // Enable/disable confirm button based on checkbox\r\n      const updateConfirmButton = () => {\r\n        if (checkbox.checked) {\r\n          confirmBtn.disabled = false;\r\n          confirmBtn.style.opacity = '1';\r\n        } else {\r\n          confirmBtn.disabled = true;\r\n          confirmBtn.style.opacity = '0.5';\r\n        }\r\n      };\r\n\r\n      checkbox.addEventListener('change', updateConfirmButton);\r\n\r\n      // Event handlers\r\n      cancelBtn.addEventListener('click', () => {\r\n        document.body.removeChild(overlay);\r\n        resolve(false);\r\n      });\r\n\r\n      confirmBtn.addEventListener('click', () => {\r\n        if (checkbox.checked) {\r\n          document.body.removeChild(overlay);\r\n          resolve(true);\r\n        }\r\n      });\r\n\r\n      // Close on overlay click\r\n      overlay.addEventListener('click', (e) => {\r\n        if (e.target === overlay) {\r\n          document.body.removeChild(overlay);\r\n          resolve(false);\r\n        }\r\n      });\r\n\r\n      // Close on Escape key\r\n      const handleEscape = (e: KeyboardEvent) => {\r\n        if (e.key === 'Escape') {\r\n          document.body.removeChild(overlay);\r\n          document.removeEventListener('keydown', handleEscape);\r\n          resolve(false);\r\n        }\r\n      };\r\n      document.addEventListener('keydown', handleEscape);\r\n    });\r\n  };\r\n\r\n  const handleImportComplete = async (result: any) => {\r\n    // Reload data after successful import\r\n    await loadSettings();\r\n    await loadMachines();\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"page-loading\">\r\n        <LoadingSpinner size=\"lg\" />\r\n        <p>Loading settings...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!settings) {\r\n    return (\r\n      <div className=\"page-error\">\r\n        <h2>Failed to load settings</h2>\r\n        <button onClick={loadSettings} className=\"btn btn-primary\">\r\n          Retry\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"settings-page\">\r\n      <div className=\"page-header\">\r\n        <h1 className=\"page-title\">Settings</h1>\r\n        <p className=\"page-subtitle\">\r\n          Manage your app preferences and data\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"settings-sections\">\r\n        {/* Appearance Settings */}\r\n        <div className=\"settings-section\">\r\n          <h3>Appearance</h3>\r\n          \r\n          <div className=\"setting-item\">\r\n            <div className=\"setting-info\">\r\n              <label className=\"setting-label\">Dark Mode</label>\r\n              <p className=\"setting-description\">\r\n                Enable dark theme for better viewing in low light\r\n              </p>\r\n            </div>\r\n            <label className=\"toggle-switch\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={settings.darkMode}\r\n                onChange={(e) => handleSettingChange('darkMode', e.target.checked)}\r\n                aria-label=\"Toggle dark mode\"\r\n              />\r\n              <span className=\"toggle-slider\"></span>\r\n            </label>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Backup Settings */}\r\n        <div className=\"settings-section\">\r\n          <h3>Backup & Restore</h3>\r\n          \r\n          <div className=\"setting-item\">\r\n            <div className=\"setting-info\">\r\n              <label className=\"setting-label\">Auto Backup</label>\r\n              <p className=\"setting-description\">\r\n                Automatically backup data to browser storage\r\n              </p>\r\n            </div>\r\n            <label className=\"toggle-switch\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={settings.autoBackup}\r\n                onChange={(e) => handleSettingChange('autoBackup', e.target.checked)}\r\n                aria-label=\"Toggle auto backup\"\r\n              />\r\n              <span className=\"toggle-slider\"></span>\r\n            </label>\r\n          </div>\r\n\r\n          <div className=\"setting-item\">\r\n            <div className=\"setting-info\">\r\n              <label className=\"setting-label\">Default Encryption</label>\r\n              <p className=\"setting-description\">\r\n                Encrypt exports by default (you can still choose per export)\r\n              </p>\r\n            </div>\r\n            <label className=\"toggle-switch\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={settings.defaultEncryption}\r\n                onChange={(e) => handleSettingChange('defaultEncryption', e.target.checked)}\r\n                aria-label=\"Toggle default encryption\"\r\n              />\r\n              <span className=\"toggle-slider\"></span>\r\n            </label>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Data Management */}\r\n        <div className=\"settings-section\">\r\n          <h3>Data Management</h3>\r\n          \r\n          <div className=\"setting-actions\">\r\n            <button onClick={clearAllData} className=\"btn btn-error\">\r\n              Clear All Data\r\n            </button>\r\n          </div>\r\n          \r\n          <div className=\"setting-info\">\r\n            <p>Use the Export & Import section below for advanced backup and restore functionality with encryption options.</p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Export/Import Section */}\r\n        <ExportImport \r\n          machines={machines} \r\n          onImportComplete={handleImportComplete}\r\n        />\r\n\r\n        {/* App Information */}\r\n        <div className=\"settings-section\">\r\n          <h3>App Information</h3>\r\n          <VersionDisplay showUpdateButton={true} />\r\n        </div>\r\n\r\n        {/* Save Button */}\r\n        <div className=\"settings-actions\">\r\n          <button\r\n            onClick={saveSettings}\r\n            disabled={saving}\r\n            className=\"btn btn-primary btn-lg\"\r\n          >\r\n            {saving ? <LoadingSpinner size=\"sm\" /> : 'Save Settings'}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Settings;\r\n"],"names":["exportService","exportData","options","backupData","version","exportDate","Date","machines","settings","history","includeMachines","indexedDBService","selectedMachineIds","length","machineId","machine","getMachine","push","getAllMachines","includeSettings","getSettings","includeHistory","getConnectionHistory","jsonString","JSON","stringify","encrypt","password","encryptedWrapper","encrypted","data","CryptoJS","toString","console","log","mimeType","Blob","type","importData","file","result","success","importedMachines","importedSettings","importedHistory","errors","warnings","fileContent","this","readFileAsText","parsedData","parse","decrypted","decrypt","Utf8","parseError","error","decryptError","validateBackupData","importBackupData","fileError","concat","generateFilename","timestamp","toISOString","replace","slice","scope","encryption","downloadBlob","blob","filename","url","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","Promise","resolve","reject","reader","FileReader","onload","e","_e$target","target","onerror","readAsText","Array","isArray","id","updateMachine","name","addMachine","machineError","historyEntry","addConnectionHistory","historyError","currentSettings","mergedSettings","mergeSettings","updateSettings","settingsError","current","imported","_objectSpread","darkMode","undefined","autoBackup","defaultEncryption","categories","from","Set","customFieldDefinitions","mergeCustomFieldDefinitions","merged","importedField","existingIndex","findIndex","field","detectEncryption","content","_unused","getExportSummary","machineCount","hasSettings","hasHistory","estimatedSizeBytes","estimatedSize","formatFileSize","bytes","i","Math","floor","parseFloat","pow","toFixed","testExportImportCycle","arguments","exportBlob","testFile","File","importResult","PasswordPrompt","_ref2","onSubmit","onCancel","setPassword","useState","_jsxs","preventDefault","trim","className","children","_jsx","value","onChange","placeholder","autoFocus","onClick","disabled","_ref","onImportComplete","isExporting","setIsExporting","isImporting","setIsImporting","exportOptions","setExportOptions","setImportResult","showPasswordPrompt","setShowPasswordPrompt","pendingFile","setPendingFile","fileInputRef","useRef","handleImport","async","alert","join","checked","prev","selectAllMachines","map","m","clearMachineSelection","includes","toggleMachineSelection","filter","anydeskId","_Fragment","LoadingSpinner","size","ref","accept","_event$target$files","event","files","htmlFor","index","warning","showUpdateButton","versionInfo","setVersionInfo","isChecking","setIsChecking","showDetails","setShowDetails","useEffect","loadVersionInfo","info","versionService","getStoredVersionInfo","getFormattedVersion","isUpdateAvailable","title","latest","lastChecked","toLocaleDateString","toLocaleTimeString","forceUpdateCheck","handleUpdate","updateUrl","window","open","location","reload","Settings","setSettings","setMachines","loading","setLoading","saving","setSaving","loadSettings","loadMachines","settingsData","documentElement","classList","add","remove","allMachines","handleSettingChange","newSettings","showBackupConfirmationDialog","overlay","style","cssText","modal","innerHTML","checkbox","querySelector","cancelBtn","confirmBtn","addEventListener","updateConfirmButton","opacity","handleEscape","key","removeEventListener","backupService","clearBackup","clearAllData","localStorage","setItem","ExportImport","VersionDisplay"],"sourceRoot":""}